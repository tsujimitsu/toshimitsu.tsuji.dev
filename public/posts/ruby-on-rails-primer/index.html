<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.59.1" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="//fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<link rel="stylesheet" href="/css/normalize.css">
<link rel="stylesheet" href="/css/skeleton.css">
<link rel="stylesheet" href="/css/custom.css">
<link rel="alternate" href="/index.xml" type="application/rss+xml" title="tsujimitsu.tsuji.dev">
<title>Ruby on Rails Primer - tsujimitsu.tsuji.dev</title>
</head>
<body>

<div class="container">

	<header role="banner">
		<div class="header-logo">
			<a href="/"><img src="" width="60" height="60" alt="tsujimitsu.tsuji.dev"></a>
		</div>
		
	</header>


	<main role="main">
		<article itemscope itemtype="http://schema.org/BlogPosting">
			<h1 class="entry-title" itemprop="headline">Ruby on Rails Primer</h1>
			<span class="entry-meta"><time itemprop="datePublished" datetime="2015-08-29">August 29, 2015</time></span>
			<section itemprop="entry-text">
				

<h1 id="ruby-on-rails-の特徴">ruby on rails の特徴</h1>

<ul>
<li>MVCモデルを採用</li>
</ul>

<h1 id="model">Model</h1>

<ul>
<li>Model は ActiveRecord を利用</li>
<li>SQLite3, MySQL, PostgreSQL に標準対応</li>
</ul>

<h1 id="view">View</h1>

<ul>
<li>ERB(Embedded RuBy), Haml, Slim といったテンプレートエンジンを利用</li>
</ul>

<h1 id="controller">Controller</h1>

<ul>
<li>Action(GET, POST, PATCH(PUT), DELETE) を定義</li>
</ul>

<h1 id="install-centos">install(centos)</h1>

<pre><code>    # ruby -v
    ruby 2.1.2p95 (2014-05-08 revision 45877) [x86_64-linux]
    
    # gem install rails
    # gem list rails
    *** LOCAL GEMS ***

    rails (4.2.4)
    rails-deprecated_sanitizer (1.0.3)
    rails-dom-testing (1.0.7)
    rails-html-sanitizer (1.0.2)
    sprockets-rails (3.0.0.beta2)

    # rbenv rehash
    # rails -v
    Rails 4.2.4

    # cd /opt/; pwd
    # rails new book_library
    # cd book_library

    # vim Gemfile
    gem 'rb-readline'

    # bundle install --path vendor/bundle

    # bundle exec rails generate scaffold book title:string author:string outline:text
    # bundle exec rake db:migrate
    # bundle exec rails server
</code></pre>

<h1 id="management-version">Management version</h1>

<pre><code>    # cd /opt/book_library; pwd
    # git init
    # vim .gitignore
    doc/
    *.swp
    *~
    .project
    .DS_Store
    .idea
    .secret

    # git add .
    # git status
    # git commit -m &quot;initialize repository&quot;
    # git log
    commit c1740fbff8c95ddf37b4e166d660ce42aee6d033
    Author: tsujimitsu &lt;tsujimitsu@codelogue.com&gt;
    Date:   Sun Aug 30 15:33:17 2015 +0900

    initialize repository

    # rm -rf app
    # ls -ld app
    ls: cannot access app: No such file or directory

    # git checkout -f
    # ls -ld app
    drwxr-xr-x 8 root root 4096 2015-08-30 15:47 app

    # git branch
    * master
    # git checkout -b modify-readme
    # git branch
      master
    * modify-readme

    # git mv README.rdoc README.md
    # git commit -a -m &quot;Improve the README file&quot;

    # git branch
      master
    * modify-readme
    # git checkout master
    # git branch
    * master
      modify-readme

    # git merge modify-readme
    # git branch -d modify-readme

    # vim Gemfile
    group :production do
      gem 'pg'
      gem 'rails_12factor'
    end
</code></pre>

<h1 id="database">Database</h1>

<ul>
<li>Active Record 経由での接続設定は config/database.yml で行う。</li>
</ul>

<h1 id="contents">Contents</h1>

<ul>
<li>静的コンテンツは root/public 配下に配置する。</li>
<li>root へのアクセスをコントローラで処理する場合は public/index.html は削除しておく。</li>
<li>部分でンプレートは「_form.html.erb」のようにアンダーバーで始める</li>
</ul>

<h1 id="heroku">Heroku</h1>

<pre><code>    # cd /tmp; pwd
    # wget -O- https://toolbelt.heroku.com/install.sh | sh
    # vim /root/.bashrc
    PATH=$PATH:/usr/local/heroku/bin
    # source /root/.bashrc
    # heroku version
    heroku-toolbelt/3.41.4 (x86_64-linux) ruby/2.1.2
    You have no installed plugins.
  
    # heroku login
    # cd /opt/book_library/; pwd
    # heroku create
    # git push heroku master

    heroku はsqliteに対応していなかったのでpostgresqlへ変更予定
</code></pre>

<h1 id="ruby">Ruby</h1>

<pre><code>    クラスのgetterは「attr_reader」で一元定義できる
    クラスのsetterは「attr_writer」で一元定義できる
    上記２つは「attr_accessor」でまとめて定義できる

    クラスメソッドは以下のようにクラス名を含めて定義する
    def Classname.data
    end
    もしくは
    def self.data
    end
    クラス変数は@@で定義する
</code></pre>

<h1 id="ruby-on-rails">ruby on rails</h1>

<ul>
<li>link_to helper でリンクは表示させる</li>
<li>リンクは名前付きルートで指定可能（/aboutであれば about_path とか）</li>
<li>view の共通部分は「application.html.erb」に記載される</li>
<li>rails console でCLI操作できる</li>
<li>rails console を見やすくするhirb, pry-rails, hirb-unicode</li>
<li>rails ではメソッド（GET, POST）をVERBという</li>
</ul>

<h1 id="crud-webサービスを構成する７つのアクション">CRUD（Webサービスを構成する７つのアクション）</h1>

<ul>
<li>create（作成）

<ul>
<li>new（新規作成画面）</li>
<li>create（作成・保存）</li>
</ul></li>
<li>read（取得）

<ul>
<li>index（一覧表示画面）</li>
<li>show（詳細表示画面）</li>
</ul></li>
<li>update（更新）

<ul>
<li>edit（更新画面）</li>
<li>update（更新・保存）</li>
</ul></li>
<li>delete（削除）

<ul>
<li>destroy（削除）</li>
</ul></li>
</ul>

<h1 id="ominiauth-facebook">ominiauth-facebook</h1>

<pre><code>    # vim Gemfile
    gem 'omniauth'
    gem 'omniauth-facebook'

    # bundle install --path vendor/bundle
    # vim ../config/initializers/omniauth.rb
    Rails.application.config.middleware.use OmniAuth::Builder do
      provider :facebook, ENV['FB_APP_ID'], ENV['FB_SECRET']
    end

    OmniAuth.config.on_failure = Proc.new { |env|
      OmniAuth::FailureEndpoint.new(env).redirect_to_failure
    }

    ... controller などを作る...

    # bundle exec rails g model SocialProfile user:references provider uid name nickname email url image_url description other:text credentials:text raw_info:text
    # bundle exec rake db:migrate

    % facebook settings - Basic
    Display name: httpproxy
    Namespace: httpproxy
    App Domains: fbproxy.codelogue.com
    Website
    - Site URL: http://fbproxy.codelogue.com:3000/

    % facebook settings - Advanced
    Server IP Whitelist: xxx.xxx.xxx.xxx
    Valid OAuth redirect URIs: http://fbproxy.codelogue.com:3000/auth/facebook/callback
</code></pre>

<ul>
<li><a href="http://paranishian.hateblo.jp/entry/rails/connect-facebook-and-googleplus-with-omniauth">omniauthでfacebook, google+のSNS連携を実装する</a></li>
<li><a href="http://qiita.com/awakia/items/03dd68dea5f15dc46c15">RailsでいろんなSNSとOAuth連携/ログインする方法</a></li>
<li><a href="http://g08m11.hateblo.jp/entry/2014/03/20/184525">facebook 認証をローカル環境で実施する方法</a></li>
<li><a href="http://stackoverflow.com/questions/12370056/omniauth-strategies-facebook-noauthorizationcodeerror-must-pass-either-a-code">OmniAuth Strategies Facebook NoAuthorizationCodeError</a></li>
<li><a href="https://coderwall.com/p/bsfitw/ruby-on-rails-4-authentication-with-facebook-and-omniauth">Ruby on Rails 4 - Authentication with Facebook and OmniAuth.</a></li>
<li><a href="http://paiza.hatenablog.com/entry/2015/07/22/2015%E5%B9%B47%E6%9C%889%E6%97%A5%E4%BB%A5%E9%99%8D%E3%81%ABFacebook%E8%AA%8D%E8%A8%BC%E3%81%A7%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%81%8C%E5%8F%96%E3%82%8C%E3%81%AA%E3%81%84">2015年7月9日以降にFacebook認証でメールアドレスが取れない問題とその対策</a></li>
<li><a href="http://qiita.com/blueplanet/items/25c815aa45cad46be73d">omniauth-facebook＋GraphAPI ver 2.4でemailフィールドが取得されない件の対応</a></li>
<li><a href="http://stackoverflow.com/questions/17858178/allow-anything-through-cors-policy">Allow anything through CORS Policy</a></li>
</ul>

<h1 id="sql">SQL</h1>

<pre><code>    bundle exec rails dbconsole
    .table
    .schema tablename
    select * from tablenamel
    .quit

    bundle exec rake db:drop:all
</code></pre>

<h1 id="bootstrap">bootstrap</h1>

<pre><code>    #rails new cafelogue --skip-bundle
    #vim Gemfile
    gem 'rb-readline'
    gem 'less-rails'
    gem 'therubyracer'
    gem 'execjs'
    gem 'twitter-bootstrap-rails'
    #bundle install --path vendor/bundle
    #bundle exec rails g scaffold user name:string password:string email:string regist_date:date
    #bundle exec rake db:migrate
    #bundle exec rails g bootstrap:install less
    #bundle exec rails g bootstrap:themed Users
</code></pre>

<ul>
<li><a href="http://qiita.com/kamizuno/items/5c3ecceea5aa78e25058">RailsにBootstrapデザインを適用する</a></li>
</ul>

<h1 id="devise-invitable">devise_invitable</h1>

<ul>
<li><a href="http://qiita.com/keisukeohta/items/e5ddf73df21fede86ddf">【ちょー簡単】Devise_Invitableを使ってユーザー招待のフローを作ってみた part.1 基本編</a></li>
<li><a href="http://izumin.hateblo.jp/entry/2015/01/13/232400">【Rails】Deviseに招待機能をつける</a></li>
</ul>

<h1 id="reference">reference</h1>

<ul>
<li><a href="http://www.atmarkit.co.jp/ait/articles/1402/28/news047.html">簡単インストールから始める初心者のためのRuby on Railsチュートリアル</a></li>
<li><a href="http://qiita.com/muran001/items/14f34b735e0a6b4af98c">初心者は覚えておきたいRubygemsのコマンドまとめ</a></li>
<li><a href="http://www.task-notes.com/entry/20150108/1420648200">Ruby on Railsの環境構築とbundlerについて</a></li>
<li><a href="http://openbook4.me/projects/92/">小学生でもわかるRuby on Rails入門</a></li>
<li><a href="http://developers.mobage.jp/blog/how-to-use-for-beginners-heroku">初心者でも15分で公開できるHerokuのはじめかた</a></li>
</ul>

			</section>
		</article>
	</main>


	<footer role="contentinfo">
		<div class="hr"></div>
		<div class="footer-link">
			
			<a href="https://twitter.com/tsujimitsu" target="_blank">Twitter</a>
			<a href="https://www.facebook.com/tsujimitsu" target="_blank">Facebook</a>
			<a href="https://github.com/tsujimitsu/" target="_blank">GitHub</a>
			
		</div>
		<div class="copyright">Copyright &copy; </div>
	</footer>

</div>

<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-152694591-1', 'auto');
	ga('send', 'pageview');
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>
